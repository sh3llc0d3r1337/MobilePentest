
var resolver = new ApiResolver('objc');
var f1 = {};

resolver.enumerateMatches('-[NSMutableURLRequest setHTTPBody:]', {
	onMatch: function(match) {
		if (match.name.indexOf('-[NSMutableURLRequest setHTTPBody:]') > -1) {
			f1.name = match.name;
			f1.address = match.address;
			console.log('-[NSMutableURLRequest setHTTPBody:] found');
		}
	},
	onComplete: function() {
	}
});

if (f1.address) {
	Interceptor.attach(f1.address, {
		onEnter: function(args) {
			var param1 = new ObjC.Object(args[2]);
			var dmp = Memory.readUtf8String(param1.bytes(), param1.length());
			console.log('-[NSMutableURLRequest setHTTPBody:] - ' + dmp);
		}
		,onLeave: function (retval) {
		}
	});
}
