
var resolver = new ApiResolver('objc');
var f1 = {};
var f2 = {};
var f3 = {};
var f4 = {};



// -[NSMutableURLRequest setHTTPMethod:]
resolver.enumerateMatches('-[NSMutableURLRequest setHTTPMethod:]', {
        onMatch: function(match) {
                if (match.name.indexOf('-[NSMutableURLRequest setHTTPMethod:]') > -1) {
                        f2.name = match.name;
                        f2.address = match.address;
                        console.log('-[NSMutableURLRequest setHTTPMethod:] found');
                }
        },
        onComplete: function() {
        }
});

if (f2.address) {
        Interceptor.attach(f2.address, {
                onEnter: function(args) {
                        var param1 = new ObjC.Object(args[2]);
                        console.log('-[NSMutableURLRequest setHTTPMethod:"' + param1 + '"]');
                }
                ,onLeave: function (retval) {
                }
        });
}


// -[NSMutableURLRequest setValue:forHTTPHeaderField:]
resolver.enumerateMatches('-[NSMutableURLRequest setValue:forHTTPHeaderField:]', {
        onMatch: function(match) {
                if (match.name.indexOf('-[NSMutableURLRequest setValue:forHTTPHeaderField:]') > -1) {
                        f3.name = match.name;
                        f3.address = match.address;
                        console.log('-[NSMutableURLRequest setValue:forHTTPHeaderField:] found');
                }
        },
        onComplete: function() {
        }
});

if (f3.address) {
        Interceptor.attach(f3.address, {
                onEnter: function(args) {
                        var param1 = new ObjC.Object(args[2]);
			var param2 = new ObjC.Object(args[3]);
                        console.log('-[NSMutableURLRequest setValue:"' + param1 + '" forHTTPHeaderField:"' + param2 + '"]');
                }
                ,onLeave: function (retval) {
                }
        });
}


// -[NSMutableURLRequest setHTTPBody:]
resolver.enumerateMatches('-[NSMutableURLRequest setHTTPBody:]', {
	onMatch: function(match) {
		if (match.name.indexOf('-[NSMutableURLRequest setHTTPBody:]') > -1) {
			f4.name = match.name;
			f4.address = match.address;
			console.log('-[NSMutableURLRequest setHTTPBody:] found');
		}
	},
	onComplete: function() {
	}
});

if (f4.address) {
	Interceptor.attach(f4.address, {
		onEnter: function(args) {
			var param1 = new ObjC.Object(args[2]);
			var dmp = Memory.readUtf8String(param1.bytes(), param1.length());
			console.log('-[NSMutableURLRequest setHTTPBody:"' + dmp + '"]');
		}
		,onLeave: function (retval) {
		}
	});
}
